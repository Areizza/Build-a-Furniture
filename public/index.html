<!DOCTYPE html>
<html>
<head>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>
    <script src="https://unpkg.com/aframe-physics-extras@0.1.2/dist/aframe-physics-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@^4.0.0/dist/aframe-event-set-component.min.js"></script>
    <script src="https://unpkg.com/super-hands@3.0.0/dist/super-hands.min.js"></script>
    <script>
        // Prevent context menu.
        document.addEventListener("contextmenu", function (e) {
            e.preventDefault();
            console.log("Context menu disabled for right click.")
        }, false);
    </script>
    <!--https://softwareengineering.stackexchange.com/questions/213332/best-way-to-define-snap-points-between-two-arbitrary-objects-in-3d-->
</head>
    <body>
        <a-scene touch-to-click-converter physics="debug: true;">
            <a-assets>
                <a-mixin id="pointer"
                         raycaster="showLine: true; objects: .part, a-link"
                         super-hands="colliderEvent: raycaster-intersection;
                               colliderEventProperty: els;
                               colliderEndEvent:raycaster-intersection-cleared;
                               colliderEndEventProperty: clearedEls;">
                </a-mixin>
                <a-mixin id="sphereCollider"
                         geometry="primitive: sphere; radius: 0.12;"
                         static-body
                         physics-collider="ignoreSleep: true;"
                         collision-filter="group: snapPoints; collidesWith: snapPoints; collisionForces: false;"
                         material="color: blue; shader: flat; opacity: 0.4;"
                         transparent="true" >
                </a-mixin>

                <a-mixin id="part"
                         hoverable grabbable draggable droppable
                         shadow
                         event-set__hoveron="_event: hover-start; material.opacity: 0.8; transparent: true"
                         event-set__hoveroff="_event: hover-end; material.opacity: 1; transparent: false">
                </a-mixin>

                <a-mixin id="tableLeg"
                         mixin="part"
                         geometry="primitive: box; width: 0.18; height: 1; deptwh: 0.18;"
                         body="type: dynamic; mass: 5; shape: none;"
                         shape__main="shape: box;
                                   halfExtents: 0.09 0.5 0.09"
                         material="color: #4d2600;">

                </a-mixin>

                <!--event-set__dragdrop="_event: drag-drop; geometry.radius: 0.25; geometry.primitive: sphere"-->
                <!--event-set__dragon="_event: dragover-start; material.wireframe: true"-->
                <!--event-set__dragoff="_event: dragover-end; material.wireframe: false"-->

            </a-assets>

            <a-entity id="tableTop"
                      class="grabbable"
                      mixin="part"
                      geometry="primitive: box; width: 2.6; height: 0.18; depth: 1.8;"
                      position="0 0.09 0"
                      material="color: #663300;"
                      body="type: dynamic; mass: 20; shape: none;"
                      shape__main="shape: box;
                                halfExtents: 1.3 0.09 0.9">

                <a-entity position="1.13 0.08 0.73"
                          mixin="sphereCollider">
                </a-entity>
                <a-entity position="-1.13 0.08 -0.73"
                          mixin="sphereCollider">
                </a-entity>
                <a-entity position="-1.13 0.08 0.73"
                          mixin="sphereCollider">
                </a-entity>
                <a-entity position="1.13 0.08 -0.73"
                          mixin="sphereCollider">
                </a-entity>
            </a-entity>

            <!--<a-entity dynamic-body="shape: none"
              body-merger="dynamic-body"
              position="0 2 0">
        <a-entity id="tableTop"w
                  mixin="part"
                  dynamic-body
                  geometry="primitive: box; width: 2.6; depth: 1.8; height: 0.18"
                  position="0 1 0"
                  material="color: #663300;">
        </a-entity>

        <a-entity geometry="primitive: sphere; radius: 0.15; thetaLength: 90;"
                  position="0 0.08 0"
                  sphere-collider
                  material="color: blue; shader: flat">

        </a-entity>
    </a-entity>-->

            <!-- Table Legs-->
            <a-entity id="tableLeg_BR"
                      class=grabbable
                      mixin="tableLeg"
                      position="0 0.7 -4">
                <a-entity position="0 0.5 0"
                          mixin="sphereCollider">
                </a-entity>
            </a-entity>
            <a-entity id="tableLeg_TR"
                      class=grabbable
                      mixin="tableLeg"
                      position="3 0.7 -1.5">
                <a-entity position="0 0.5 0"
                          mixin="sphereCollider">
                </a-entity>
            </a-entity>
            <a-entity id="tableLeg_BL"
                      class=grabbable
                      mixin="tableLeg"
                      position="-3.2 0.7 -1">
                <a-entity position="0 0.5 0"
                          mixin="sphereCollider">
                </a-entity>
            </a-entity>
            <a-entity id="tableLeg_TL"
                      class=grabbable
                      mixin="tableLeg"
                      position="-2.5 0.7 -4.5">
                <a-entity position="0 0.5 0"
                          mixin="sphereCollider">
                </a-entity>
            </a-entity>

            <a-entity camera
                      wasd-controls
                      look-controls="pointerLockEnabled:true"
                      position="0 1.2 1.5"
                      capture-mouse
                      raycaster="objects: .grabbable" cursor="rayOrigin:mouse"
                      static-body="shape: sphere; sphereRadius: 0.0002"
                      super-hands="colliderEvent: raycaster-intersection;
                             colliderEventProperty: els;
                             colliderEndEvent:raycaster-intersection-cleared;
                             colliderEndEventProperty: clearedEls;">
            </a-entity>

            <a-entity id="groundPlane"
                      position="0 0 0"
                      rotation="-90 0 0"
                      scale="1 1 1"
                      geometry="primitive: plane; width: 25.0; height: 25.0"
                      material="color: green; shader: flat"
                      static-body
                      shadow>
            </a-entity>

            <!-- Tried to add a cursor retical -->
            <!--<a-entity camera
              wasd-controls
              look-controls="pointerLockEnabled:true"
              position="0 1.2 1.5">
        <a-entity cursor="rayOrigin:mouse"
                  raycaster="objects: .cube"
                  capture-mouse
                  static-body="shape: sphere; sphereRadius: 0.001"
                  super-hands="colliderevent: raycaster-intersection;
                          collidereventproperty: els;
                          colliderendevent: raycaster-intersection-cleared;
                          colliderendeventproperty: clearedels"
                  geometry="primitive: ring; radiusinner: 0.1; radiusouter: 0.12"
                  material="color: black; shader: flat"
                  position="0 0 -1.5">
        </a-entity>
    </a-entity>-->
            <!--<a-entity class="rig" movement-controls="controls:keyboard; constraintonavmesh:true; speed:0.25" rotation="" keyboard-controls="">
        <a-entity camera="" look-controls="pointerlockenabled:true" position="0 1.6 0" rotation="">
            <a-entity cursor="fuse: false; fusetimeout: 500"
                      raycaster="objects: .clickable"
                      super-hands="colliderevent: raycaster-intersection;
                          collidereventproperty: els;
                          colliderendevent: raycaster-intersection-cleared;
                          colliderendeventproperty: clearedels"
                      geometry="primitive: ring; radiusinner: 0.01; radiusouter: 0.012"
                      material="color: black; shader: flat"
                      position="0 0 -0.5">
            </a-entity>
        </a-entity>
    </a-entity>-->
        </a-scene>
    </body>
</html>